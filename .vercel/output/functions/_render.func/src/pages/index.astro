---
import ProjectCard from "../components/ProjectCard.astro";
import { HOMEPAGE_PROJECTS_LIMIT } from "../lib/constants";
import MainLayout from "../layouts/MainLayout.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";
import { Image } from "astro:assets";
import myPhoto from "../images/default-avatar.svg";
import Separator from "@/components/common/Separator.astro";

const homeUiContent: CollectionEntry<"ui"> = await getEntry("ui", "home")!;

const allProjects: CollectionEntry<"project">[] = (
  await getCollection("project")
).sort(
  (a: CollectionEntry<"project">, b: CollectionEntry<"project">) =>
    b.data.weight.valueOf() - a.data.weight.valueOf()
);

const { mainTitle } = homeUiContent.data;
const { Content } = await homeUiContent.render();
---

<MainLayout>
  <section class="grid grid-cols-1 gap-5 lg:grid-cols-2">
    <div class="w-full flex justify-center items-center md:mb-0">
      <div class="flex items-center justify-center">
        <Image
          src={myPhoto}
          class="min-h-20 md:w-36 md:h-36 rounded-full w-24 h-24 shadow-lg"
          alt="Abdul Aliyev Photo"
          width={200}
          height={200}
        />
      </div>
    </div>
    <div>
      <h1 class="mb-5 md:mb-8 md:leading-relaxed text-center">{mainTitle}</h1>
      <article class="leading-relaxed md:leading-loose"><Content /></article>
    </div>
  </section>
  <Separator />
  <section class="flex flex-col justify-center items-center w-full">
    <h1 class="mb-8 md:mb-12">My Projects</h1>
    <div
      class="grid grid-cols-1 gap-8 sm:gap-12 md:gap-16 lg:grid-cols-2 xl:grid-cols-3 place-items-center w-full"
    >
      {
        allProjects
          // .slice(0, HOMEPAGE_PROJECTS_LIMIT)
          .map((project) => <ProjectCard project={project} />)
      }
    </div>
  </section>
  <Separator />
</MainLayout>
